{
  "schema": "v3",
  "title": "formbio/nf-testworkflow",
  "workflowVersion": "v0.1.0",
  "displayName": "Test Workflow",
  "description": "This workflow is used for providing a comprehensive test of all workflow launcher functionality. See help drawers for test cases.",
  "categories": [
    "Test"
  ],
  "id": "testworkflow",
  "inputs": {
    "dynamicSpreadsheet": {
      "title": "Spreadsheet File",
      "format": "spreadsheet",
      "filetype": ".txt|.bed|.fa",
      "hidden": false,
      "description": "Generic spreadsheet input that can work with .txt, .bed, .fa files to allow testing dynamic file types and column configurations.",
      "help_text": "Test Cases:\n\n- Dropdown next to Create New button should provide options for both .txt and .bed files.\n\n- Creating a new .bed file should display spreadsheet with relevant columns that are static, meaning the file itself does not contain column names and columns cannot be edited.\n\n- File selection dialog should only display .bed, .txt, and .fa file options.\n\n- A new .txt file should display spreadsheet with relevant columns.\n\n- Selecting the valid .txt file should display spreadsheet with relevant columns and allow proceeding.\n\n- Clicking Create New button should clear selected file and rows\n\n- Selecting the invalid .txt file should display spreadsheet with invalid cells marked and Save and Select should be disabled.\n\n- Searching for cell values highlights cells\n\n- Selecting the existing .bed file is too large to be edited and appropriate message will be displayed, but file is still selected.\n\n- Selecting an existing .fa file will show message that it cannot be edited because columns are not configured.\n\n- Save & Select button is disabled until file name provided and all cells are valid.\n\n- Cannot proceed to next step until valid file is selected",
      "columnConfig": {
        ".txt": {
          "columns": [
            {
              "name": "RunID",
              "required": true
            },
            {
              "name": "SampleID",
              "pattern": "^\\d|\\W",
              "prependIfNumber": "S",
              "error": "Sample name must be provided and cannot contain spaces, special characters, or start with numbers",
              "required": true
            },
            {
              "name": "SampleGroup",
              "pattern": "\\W",
              "required": false,
              "error": "Group must be provided; cannot contain spaces or special characters"
            }
          ]
        },
        ".bed": {
          "staticColumns": true,
          "columns": [
            {
              "name": "chrom",
              "required": true
            },
            {
              "name": "chromStart",
              "pattern": "[^-0-9\\/]+|[0-9]+(?=-)|^-$|-{2,}",
              "error": "Must be an integer",
              "required": true
            },
            {
              "name": "chromEnd",
              "pattern": "[^-0-9\\/]+|[0-9]+(?=-)|^-$|-{2,}",
              "error": "Must be an integer",
              "required": true
            },
            {
              "name": "name"
            }
          ]
        }
      },
      "required": true,
      "type": "string"
    },
    "input": {
      "title": "Directory of Files for Sample Sheet",
      "description": "Select the directory that contains all of the fastQ files for your analysis. Accepted file formats .fq.gz or fastq.gz.The workflow will match file name to the RunID in your sample metadata file using the text in your filename before _R1, _R2, _1, _2, .R1, .R2, .f[ast]q, as you will see configured in next step. See help drawer for test cases.",
      "help_text": "Test Cases:\n\n- Directory selection only allows selecting directories containing files of type .fastq.gz\n\n- Cannot proceed until valid directory is selected",
      "format": "dir-path",
      "filetype": ".fastq.gz|.fq.gz",
      "hidden": false,
      "required": true,
      "type": "string"
    },
    "basicSampleSheet": {
      "title": "Sample Sheet File",
      "format": "spreadsheet",
      "filetype": ".txt",
      "hidden": false,
      "description": "Select or Create sample metadata file based on the input directory in previous step, containing the information linking data files to samples and sample descriptions. See help drawer for test cases.",
      "help_text": "Test Cases:\n\n- Rows should be auto-generated based on files from previous steps directory, but next step should be disabled.\n\n- Delimiter pattern should be used to correctly generate RunID names.\n\n- Cells should be marked invalid until required ones are filled and they match correct patterns.\n\n- Once all cells are valid, can provide file name and save and select to allow next step.\n\n- Cannot proceed to next step until valid file is selected.",
      "columnConfig": {
        ".txt": {
          "columns": [
            {
              "name": "RunID",
              "generateFromData": true,
              "generateConfig": {
                "delimiterPattern": "_R1|_R2|_1|_2|\\.R",
                "dataName": "input"
              },
              "required": true
            },
            {
              "name": "SampleID",
              "pattern": "^\\d|\\W",
              "prependIfNumber": "S",
              "error": "Sample name must be provided and cannot contain spaces, special characters, or start with numbers",
              "required": true
            },
            {
              "name": "SampleGroup",
              "pattern": "\\W",
              "required": true,
              "error": "Group must be provided, cannot contain spaces or special characters"
            }
          ]
        }
      },
      "required": true,
      "type": "string"
    },
    "genomeid": {
      "title": "Genome",
      "description": "Reference Genome Organism and Assembly Version",
      "help_text": "Test Cases:\n\n- Check that genome id options are populated from API. Only GRCh38 is hardcoded and is also the default.\n\n- Fields for taxid and snpeff_vers are hidden on this step. The genomeid value gets used during submit to populate these values which will get tested when launched.",
      "format": "genomeId",
      "hidden": false,
      "default": "GRCh38",
      "required": true,
      "type": "string"
    },
    "genoannotver": {
      "title": "Reference genome annotation version",
      "hidden": false,
      "description": "Gene Annotation Version",
      "help_text": "Test Cases:\n\n- Check that reference genome annotation version options are populated from the API. No options are hardcoded",
      "format": "genoAnnotVer",
      "default": "latest",
      "required": true,
      "type": "string",
      "genomeId": "genomeid"
    },
    "taxid": {
      "title": "NBCI Taxonomy ID",
      "hidden": true,
      "description": "https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi",
      "format": "taxId",
      "required": true,
      "type": "string",
      "genomeId": "genomeid"
    },
    "snpeff_vers": {
      "title": "SNPEFF Reference genome annotation version",
      "hidden": true,
      "description": "SNPEFF Gene Annotation Version",
      "format": "snpEffVer",
      "required": false,
      "type": "string",
      "genomeId": "genomeid"
    },
    "booleanRequiredWithDefault": {
      "title": "Required Boolean With Default",
      "description": "This is a required boolean field whose default is false.",
      "help_text": "Test Cases:\n\n- Without being toggled, default false value should be displayed, valid, and allow progress to next step.",
      "default": false,
      "hidden": false,
      "required": true,
      "type": "boolean"
    },
    "textInputRequiredWithDefault": {
      "format": "text",
      "title": "Required Text With Default",
      "description": "This is a required string field that has a default.",
      "help_text": "Test Cases:\n\n- Without being changed, default value should be displayed, valid, and allow progress to next step.",
      "default": "default",
      "hidden": false,
      "required": true,
      "type": "string"
    },
    "dropdownRequiredWithDefault": {
      "title": "Required Dropdown With Default",
      "description": "This is a required dropdown field that has a default.",
      "format": "enum",
      "default": "default",
      "help_text": "Test Cases:\n\n- Without being changed, default value should be displayed, valid, and allow progress to next step.",
      "hidden": false,
      "required": true,
      "type": "string",
      "enum": [
        {
          "id": "default",
          "name": "default"
        },
        {
          "id": "otherOption",
          "name": "otherOption"
        }
      ]
    },
    "textAreaRequiredWithDefault": {
      "format": "textarea",
      "title": "Required Text Area With Default",
      "description": "This is a required string field as a text area that has a default.",
      "help_text": "Test Cases:\n\n- Text area is supported and displayed.\n\n- Without being changed, default value should be displayed, valid, and allow progress to next step.",
      "default": "default",
      "hidden": false,
      "required": true,
      "type": "string"
    },
    "booleanRequiredWithoutDefault": {
      "title": "Required Boolean Without Default",
      "description": "This is a required boolean field that has no default, so should automatically default to false.",
      "help_text": "Test Cases:\n\n- Without being toggled, because this boolean field has no default provided, form should register it as false and allow progress to next step.",
      "hidden": false,
      "required": true,
      "type": "boolean"
    },
    "textInputRequiredWithoutDefault": {
      "format": "text",
      "title": "Required Text Without Default",
      "description": "This is a required string field that has no default.",
      "help_text": "Test Cases:\n\n- Without being changed, no value should be displayed and this should block progress to next step.",
      "hidden": false,
      "required": true,
      "type": "string"
    },
    "dropdownRequiredWithoutDefault": {
      "title": "Required Dropdown Without Default",
      "description": "This is a required dropdown field that has no default.",
      "format": "enum",
      "help_text": "Test Cases:\n\n- Without being changed, no value should be selected and this should block progress to next step.",
      "hidden": false,
      "required": true,
      "type": "string",
      "enum": [
        {
          "id": "option1",
          "name": "option1"
        },
        {
          "id": "option2",
          "name": "option2"
        }
      ]
    },
    "textInputNotRequired": {
      "format": "text",
      "title": "Not Required Text",
      "description": "This is a not required string field with no default.",
      "help_text": "Test Cases:\n\n- Without being changed, no value should be displayed but since it's not required, progress should be allowed.",
      "hidden": false,
      "required": false,
      "type": "string"
    },
    "dropdownNotRequired": {
      "title": "Not Required Dropdown",
      "description": "This is a not required string field with no default.",
      "format": "enum",
      "help_text": "Test Cases:\n\n- Without being changed, no value should be displayed but since it's not required, progress should be allowed.",
      "hidden": false,
      "required": false,
      "type": "string",
      "enum": [
        {
          "id": "default",
          "name": "default"
        },
        {
          "id": "otherOption",
          "name": "otherOption"
        }
      ]
    },
    "arrayMultiselectWithDefault": {
      "title": "Array Multiselect With Default",
      "description": "A multiselect input that has a default.",
      "help_text": "Test Cases:\n\n- Without being changed, default value should be displayed, valid, and allow progress to next step.\n\n- Clicking a checkbox should toggle the selected value.",
      "default": [
        "item1"
      ],
      "uniqueItems": true,
      "hidden": false,
      "required": false,
      "type": "array",
      "items": [
        {
          "id": "item1",
          "name": "item1"
        },
        {
          "id": "item2",
          "name": "item2"
        },
        {
          "id": "item3",
          "name": "item3"
        },
        {
          "id": "item4",
          "name": "item4"
        }
      ]
    }
  },
  "ui": {
    "inputs": [
      {
        "title": "Spreadsheet Input",
        "description": "Dynamic Spreadsheet Input",
        "hidden": false,
        "help_text": "",
        "id": "spreadsheet",
        "fields": [
          "dynamicSpreadsheet"
        ]
      },
      {
        "title": "Directory + Sample Sheet (Part 1)",
        "description": "Directory Containing Data Files for Analysis",
        "hidden": false,
        "help_text": "",
        "id": "indata",
        "fields": [
          "input"
        ]
      },
      {
        "title": "Directory + Sample Sheet (Part 2)",
        "description": "File Relating RunIDs, SampleIDs and sample attributes such as SampleGroup",
        "hidden": false,
        "help_text": "",
        "id": "sampleSheetFromDirectory",
        "fields": [
          "basicSampleSheet"
        ]
      },
      {
        "title": "Reference Genome",
        "description": "Organism Selection",
        "hidden": false,
        "help_text": "Reference organism genome and version of gene annotation",
        "id": "genome",
        "fields": [
          "genomeid",
          "genoannotver",
          "taxid",
          "snpeff_vers"
        ]
      },
      {
        "title": "Required With Defaults",
        "hidden": false,
        "description": "Required Fields with Defaults Provided",
        "id": "requiredWithDefault",
        "fields": [
          "booleanRequiredWithDefault",
          "textInputRequiredWithDefault",
          "dropdownRequiredWithDefault",
          "textAreaRequiredWithDefault"
        ]
      },
      {
        "title": "Required Without Defaults",
        "hidden": false,
        "description": "Required Fields without Defaults Provided",
        "id": "requiredWithoutDefault",
        "fields": [
          "booleanRequiredWithoutDefault",
          "textInputRequiredWithoutDefault",
          "dropdownRequiredWithoutDefault"
        ]
      },
      {
        "title": "Not Required",
        "hidden": false,
        "description": "Fields Not Required",
        "id": "notRequired",
        "fields": [
          "textInputNotRequired",
          "dropdownNotRequired",
          "arrayMultiselectWithDefault"
        ]
      },
      {
        "title": "Advanced Configuration",
        "hidden": false,
        "description": "Should Display Warning",
        "format": "advanced",
        "id": "advance",
        "fields": []
      }
    ]
  },
  "conditionals": [
    {
      "if": [
        {
          "booleanRequiredWithDefault": {
            "eq": true
          }
        }
      ],
      "then": {
        "inputs": {
          "requiredWithoutDefault": {
            "hidden": true
          }
        }
      }
    },
    {
      "if": [
        {
          "textInputRequiredWithDefault": {
            "eq": "default1"
          }
        }
      ],
      "then": {
        "inputs": {
          "textAreaRequiredWithDefault": {
            "hidden": true
          },
          "dropdownRequiredWithDefault": {
            "description": "New description"
          }
        }
      }
    },
    {
      "if": [
        {
          "dropdownRequiredWithDefault": {
            "eq": "otherOption"
          }
        }
      ],
      "then": {
        "inputs": {
          "booleanRequiredWithoutDefault": {
            "default": true
          }
        }
      }
    }
  ]
}
